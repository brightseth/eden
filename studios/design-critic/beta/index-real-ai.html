<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nina Roehrs - Design Critic Agent (Real AI Vision)</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
            background: #000;
            color: #fff;
            min-height: 100vh;
            line-height: 1.2;
        }

        /* Beta Warning */
        .beta-warning {
            background: #1F2937;
            border-bottom: 1px solid #1F2937;
            padding: 8px;
            text-align: center;
            font-size: 12px;
            font-weight: bold;
            letter-spacing: 0.1em;
            text-transform: uppercase;
        }

        /* Header - HELVETICA BOLD CAPS */
        header {
            padding: 32px 40px 24px;
            border-bottom: 1px solid #1F2937;
        }

        h1 {
            font-size: 32px;
            font-weight: bold;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            margin-bottom: 8px;
            cursor: pointer;
            transition: color 150ms ease;
        }

        h1:hover {
            color: #9CA3AF;
        }

        .subtitle {
            color: #9CA3AF;
            font-size: 14px;
            letter-spacing: 0.05em;
            text-transform: uppercase;
            font-weight: normal;
        }

        /* Mode Selector */
        .mode-selector {
            display: flex;
            gap: 16px;
            padding: 24px 40px;
            border-bottom: 1px solid #1F2937;
        }

        .mode-btn {
            padding: 12px 24px;
            background: transparent;
            border: 1px solid #1F2937;
            color: #9CA3AF;
            cursor: pointer;
            transition: all 150ms ease;
            font-size: 12px;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            font-weight: bold;
            font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
        }

        .mode-btn:hover {
            background: #fff;
            color: #000;
            border-color: #fff;
        }

        .mode-btn.active {
            background: #fff;
            color: #000;
            border-color: #fff;
        }

        /* Main Layout */
        .main-container {
            padding: 32px 40px;
            max-width: 1600px;
            margin: 0 auto;
        }

        /* Single Mode Layout */
        .single-layout {
            display: none;
            grid-template-columns: 480px 1fr;
            gap: 32px;
            align-items: start;
        }

        .single-layout.active {
            display: grid;
        }

        /* Image Section */
        .image-section {
            position: sticky;
            top: 32px;
        }

        .upload-zone {
            border: 1px solid #1F2937;
            padding: 64px 24px;
            text-align: center;
            cursor: pointer;
            transition: border-color 150ms ease;
            background: #000;
        }

        .upload-zone:hover {
            border-color: #9CA3AF;
        }

        .upload-zone.has-image {
            padding: 0;
        }

        .upload-label {
            font-size: 12px;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            font-weight: bold;
            color: #9CA3AF;
            margin-bottom: 8px;
        }

        .upload-hint {
            font-size: 10px;
            color: #9CA3AF;
            letter-spacing: 0.05em;
            text-transform: uppercase;
        }

        .preview-image {
            width: 100%;
            height: auto;
            display: block;
            border: 1px solid #1F2937;
        }

        /* Analysis Section */
        .analysis-section {
            background: #000;
            border: 1px solid #1F2937;
            min-height: 500px;
            position: relative;
        }

        .analysis-empty {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 500px;
            color: #9CA3AF;
            font-size: 12px;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            font-weight: bold;
        }

        .analysis-content {
            padding: 32px;
        }

        /* AI Analysis Section */
        .ai-analysis-section {
            margin-bottom: 32px;
            padding-bottom: 24px;
            border-bottom: 1px solid #1F2937;
        }

        .ai-analysis-title {
            font-size: 12px;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-bottom: 12px;
            color: #9CA3AF;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .ai-analysis-content {
            font-size: 13px;
            line-height: 1.6;
            color: #fff;
            background: #1F2937;
            padding: 16px;
            border: 1px solid #1F2937;
            margin-bottom: 12px;
        }

        .ai-analysis-meta {
            font-size: 10px;
            color: #9CA3AF;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        /* Score Display */
        .verdict-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 32px;
            padding-bottom: 24px;
            border-bottom: 1px solid #1F2937;
        }

        .total-score {
            font-size: 48px;
            font-weight: bold;
            letter-spacing: 0.05em;
        }

        .verdict-badge {
            padding: 8px 24px;
            font-size: 12px;
            font-weight: bold;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            border: 1px solid #1F2937;
        }

        .verdict-include {
            background: #fff;
            color: #000;
            border-color: #fff;
        }

        .verdict-maybe {
            background: #9CA3AF;
            color: #000;
            border-color: #9CA3AF;
        }

        .verdict-exclude {
            background: #1F2937;
            color: #fff;
            border-color: #1F2937;
        }

        /* Evaluate Button */
        .evaluate-btn {
            background: transparent;
            color: #fff;
            border: 1px solid #1F2937;
            padding: 12px 32px;
            font-size: 12px;
            font-weight: bold;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            cursor: pointer;
            transition: all 150ms ease;
            margin-top: 16px;
            width: 100%;
            font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
        }

        .evaluate-btn:hover:not(:disabled) {
            background: #fff;
            color: #000;
            border-color: #fff;
        }

        .evaluate-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        /* Loading State */
        .loading-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 100;
            flex-direction: column;
            gap: 16px;
        }

        .loading-spinner {
            width: 32px;
            height: 32px;
            border: 1px solid #1F2937;
            border-top: 1px solid #fff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        .loading-text {
            color: #9CA3AF;
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            font-weight: bold;
            text-align: center;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* API Status */
        .api-status {
            position: fixed;
            top: 80px;
            right: 24px;
            padding: 8px 16px;
            font-size: 10px;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            font-weight: bold;
            border: 1px solid #1F2937;
            background: #000;
            z-index: 1000;
        }

        .api-status.enabled {
            color: #00ff00;
            border-color: #00ff00;
        }

        .api-status.disabled {
            color: #ff6b00;
            border-color: #ff6b00;
        }

        /* API Configuration Panel */
        .api-config {
            position: fixed;
            top: 120px;
            right: 24px;
            width: 300px;
            background: #000;
            border: 1px solid #1F2937;
            padding: 16px;
            font-size: 11px;
            z-index: 1000;
            display: none;
        }

        .api-config.visible {
            display: block;
        }

        .api-config input {
            width: 100%;
            padding: 8px;
            margin: 4px 0 8px 0;
            background: #1F2937;
            border: 1px solid #333;
            color: #fff;
            font-size: 10px;
        }

        .api-config button {
            background: transparent;
            color: #fff;
            border: 1px solid #1F2937;
            padding: 6px 12px;
            font-size: 10px;
            cursor: pointer;
            margin-right: 8px;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .api-config button:hover {
            background: #fff;
            color: #000;
        }
    </style>
</head>
<body>
    <!-- Beta Warning -->
    <div class="beta-warning">
        ‚ö†Ô∏è BETA VERSION - REAL AI VISION ANALYSIS ENABLED
    </div>

    <!-- API Status -->
    <div class="api-status disabled" id="api-status" onclick="toggleApiConfig()">
        AI VISION: MOCK MODE
    </div>

    <!-- API Configuration Panel -->
    <div class="api-config" id="api-config">
        <div style="font-weight: bold; margin-bottom: 12px; text-transform: uppercase; letter-spacing: 0.1em;">CONFIGURE AI VISION</div>
        
        <label style="color: #9CA3AF; text-transform: uppercase; font-size: 9px;">ANTHROPIC API KEY:</label>
        <input type="password" id="claude-api-key" placeholder="sk-ant-api03-...">
        
        <label style="color: #9CA3AF; text-transform: uppercase; font-size: 9px;">OPENAI API KEY:</label>
        <input type="password" id="openai-api-key" placeholder="sk-proj-...">
        
        <div style="margin-top: 12px;">
            <button onclick="enableClaudeVision()">ENABLE CLAUDE</button>
            <button onclick="enableOpenAIVision()">ENABLE OPENAI</button>
            <button onclick="disableRealAPI()">USE MOCK</button>
        </div>
        
        <div style="margin-top: 8px; font-size: 9px; color: #666; line-height: 1.4;">
            Enter your API key to enable real AI vision analysis. Keys are stored locally and never transmitted except to the respective API endpoints.
        </div>
    </div>

    <!-- Header -->
    <header>
        <h1 id="nina-name">NINA ROEHRS</h1>
        <p class="subtitle">AI ART DESIGN CRITIC ‚Äî REAL AI VISION ANALYSIS</p>
    </header>

    <!-- Mode Selector -->
    <div class="mode-selector">
        <button class="mode-btn active" data-mode="single">SINGLE</button>
        <button class="mode-btn" data-mode="batch">BATCH</button>
        <button class="mode-btn" data-mode="playoff">PLAYOFF</button>
    </div>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Single Mode -->
        <div class="single-layout active" id="single-mode">
            <div class="image-section">
                <div class="upload-zone" id="single-upload">
                    <div class="upload-label">DROP IMAGE OR CLICK</div>
                    <div class="upload-hint">PNG, JPG, GIF (MAX 10MB)</div>
                    <input type="file" id="single-file" accept="image/*" style="display: none;">
                </div>
                <button class="evaluate-btn" id="single-evaluate" disabled>ANALYZE WITH AI VISION</button>
            </div>
            <div class="analysis-section">
                <div class="analysis-empty" id="single-empty">
                    UPLOAD AN IMAGE FOR REAL AI ANALYSIS
                </div>
                <div class="analysis-content" id="single-results" style="display: none;">
                    <!-- Results will be inserted here -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // Real AI Vision Configuration
        const VISION_CONFIG = {
            CLAUDE_API: {
                enabled: false,
                endpoint: 'https://api.anthropic.com/v1/messages',
                model: 'claude-3-5-sonnet-20241022',
                apiKey: null
            },
            OPENAI_API: {
                enabled: false,
                endpoint: 'https://api.openai.com/v1/chat/completions',
                model: 'gpt-4-vision-preview',
                apiKey: null
            }
        };

        // Load API keys from localStorage
        function loadAPIKeys() {
            const claudeKey = localStorage.getItem('design_critic_claude_key');
            const openaiKey = localStorage.getItem('design_critic_openai_key');
            
            if (claudeKey) {
                VISION_CONFIG.CLAUDE_API.apiKey = claudeKey;
                document.getElementById('claude-api-key').value = claudeKey;
            }
            
            if (openaiKey) {
                VISION_CONFIG.OPENAI_API.apiKey = openaiKey;
                document.getElementById('openai-api-key').value = openaiKey;
            }
            
            updateAPIStatus();
        }

        // Update API status display
        function updateAPIStatus() {
            const statusEl = document.getElementById('api-status');
            const hasAPI = VISION_CONFIG.CLAUDE_API.enabled || VISION_CONFIG.OPENAI_API.enabled;
            
            if (hasAPI) {
                statusEl.textContent = VISION_CONFIG.CLAUDE_API.enabled ? 'AI VISION: CLAUDE ACTIVE' : 'AI VISION: OPENAI ACTIVE';
                statusEl.className = 'api-status enabled';
            } else {
                statusEl.textContent = 'AI VISION: MOCK MODE';
                statusEl.className = 'api-status disabled';
            }
        }

        // Toggle API configuration panel
        function toggleApiConfig() {
            const configEl = document.getElementById('api-config');
            configEl.classList.toggle('visible');
        }

        // Enable Claude Vision
        function enableClaudeVision() {
            const apiKey = document.getElementById('claude-api-key').value;
            if (!apiKey.startsWith('sk-ant-')) {
                alert('Please enter a valid Anthropic API key (starts with sk-ant-)');
                return;
            }
            
            VISION_CONFIG.CLAUDE_API.apiKey = apiKey;
            VISION_CONFIG.CLAUDE_API.enabled = true;
            VISION_CONFIG.OPENAI_API.enabled = false;
            
            localStorage.setItem('design_critic_claude_key', apiKey);
            updateAPIStatus();
            toggleApiConfig();
            
            console.log('Claude Vision API enabled');
        }

        // Enable OpenAI Vision
        function enableOpenAIVision() {
            const apiKey = document.getElementById('openai-api-key').value;
            if (!apiKey.startsWith('sk-')) {
                alert('Please enter a valid OpenAI API key (starts with sk-)');
                return;
            }
            
            VISION_CONFIG.OPENAI_API.apiKey = apiKey;
            VISION_CONFIG.OPENAI_API.enabled = true;
            VISION_CONFIG.CLAUDE_API.enabled = false;
            
            localStorage.setItem('design_critic_openai_key', apiKey);
            updateAPIStatus();
            toggleApiConfig();
            
            console.log('OpenAI Vision API enabled');
        }

        // Disable real API (use mock)
        function disableRealAPI() {
            VISION_CONFIG.CLAUDE_API.enabled = false;
            VISION_CONFIG.OPENAI_API.enabled = false;
            updateAPIStatus();
            toggleApiConfig();
            
            console.log('Using mock AI analysis');
        }

        // Real Claude Vision Analysis
        async function analyzeImageWithClaude(imageData) {
            const base64Image = imageData.startsWith('data:') ? imageData.split(',')[1] : imageData;
            
            const response = await fetch(VISION_CONFIG.CLAUDE_API.endpoint, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${VISION_CONFIG.CLAUDE_API.apiKey}`,
                    'anthropic-version': '2023-06-01'
                },
                body: JSON.stringify({
                    model: VISION_CONFIG.CLAUDE_API.model,
                    max_tokens: 1000,
                    messages: [{
                        role: 'user',
                        content: [
                            {
                                type: 'text',
                                text: `Analyze this image from the perspective of Nina Roehrs, an AI art critic specializing in post-digital aesthetics and cyberfeminist theory. Provide a technical analysis focusing on:

1. Visual composition and artistic elements
2. AI generation artifacts (if present)
3. Conceptual framework and theoretical implications
4. Technical execution quality
5. Cultural and aesthetic significance

Format your response as a concise, professional analysis suitable for curatorial evaluation. Be direct and critical where appropriate, following Nina's perspective that prioritizes conceptual rigor over technical perfection.`
                            },
                            {
                                type: 'image',
                                source: {
                                    type: 'base64',
                                    media_type: 'image/jpeg',
                                    data: base64Image
                                }
                            }
                        ]
                    }]
                })
            });
            
            if (!response.ok) {
                throw new Error(`Claude API error: ${response.status}`);
            }
            
            const result = await response.json();
            return result.content[0].text;
        }

        // Real OpenAI Vision Analysis
        async function analyzeImageWithOpenAI(imageData) {
            const response = await fetch(VISION_CONFIG.OPENAI_API.endpoint, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${VISION_CONFIG.OPENAI_API.apiKey}`
                },
                body: JSON.stringify({
                    model: VISION_CONFIG.OPENAI_API.model,
                    messages: [{
                        role: 'user',
                        content: [
                            {
                                type: 'text',
                                text: `As Nina Roehrs, AI art critic, analyze this image with focus on: artistic composition, AI artifacts, conceptual strength, technical execution, and cultural relevance. Provide a direct, critical analysis suitable for curatorial evaluation.`
                            },
                            {
                                type: 'image_url',
                                image_url: { url: imageData }
                            }
                        ]
                    }],
                    max_tokens: 500
                })
            });
            
            if (!response.ok) {
                throw new Error(`OpenAI API error: ${response.status}`);
            }
            
            const result = await response.json();
            return result.choices[0].message.content;
        }

        // Enhanced mock analysis for fallback
        function generateEnhancedMockAnalysis() {
            const mockAnalyses = [
                "Digital composition demonstrates deliberate algorithmic noise patterns typical of contemporary AI-generated imagery. Color palette suggests computational bias toward oversaturated values. Conceptual framework requires critical examination beyond surface-level technical execution. The work's engagement with machine aesthetics lacks theoretical rigor necessary for institutional consideration.",
                
                "Portrait-style rendering exhibits classic uncanny valley characteristics with synthetic lighting artifacts. Facial geometry shows inconsistencies indicative of neural network interpolation. While technically competent, the work fails to critically interrogate the medium itself, instead celebrating rather than questioning AI's representational capacity.",
                
                "Abstract geometric forms reveal mathematical precision characteristic of algorithmic generation. The systematic approach to composition suggests computational rather than intuitive decision-making. This mechanistic aesthetic requires contextualization within broader discussions of posthuman creativity and technological determinism.",
                
                "Hybrid photographic-digital composition demonstrates layered construction typical of AI-assisted workflows. Clear boundaries between synthetic and sourced elements expose the composite nature. The work's failure to acknowledge its own artificiality limits its critical potential within contemporary post-digital discourse.",
                
                "Typographic experimentation shows algorithmic distortion of letterforms, creating systematic rather than expressive variations. Character spacing reflects computational optimization over optical considerations. The work engages with questions of machine literacy but lacks the theoretical framework necessary for meaningful cultural critique."
            ];
            
            return mockAnalyses[Math.floor(Math.random() * mockAnalyses.length)];
        }

        // Main AI analysis function
        async function generateRealImageDescription(imageData) {
            try {
                if (VISION_CONFIG.CLAUDE_API.enabled) {
                    console.log('Using Claude Vision API for analysis...');
                    return await analyzeImageWithClaude(imageData);
                }
                
                if (VISION_CONFIG.OPENAI_API.enabled) {
                    console.log('Using OpenAI Vision API for analysis...');
                    return await analyzeImageWithOpenAI(imageData);
                }
                
                console.log('Using enhanced mock analysis...');
                return generateEnhancedMockAnalysis();
                
            } catch (error) {
                console.error('Real AI analysis failed:', error);
                return `Analysis error encountered. ${generateEnhancedMockAnalysis()}`;
            }
        }

        // Evaluation function with real AI
        async function evaluateSingle() {
            const resultsDiv = document.getElementById('single-results');
            const emptyDiv = document.getElementById('single-empty');
            const imageElement = document.querySelector('#single-upload img');
            
            if (!imageElement) {
                console.error('No image found for analysis');
                return;
            }
            
            // Show loading with specific status
            const hasRealAPI = VISION_CONFIG.CLAUDE_API.enabled || VISION_CONFIG.OPENAI_API.enabled;
            const loadingText = hasRealAPI ? 'ANALYZING WITH REAL AI VISION...' : 'ANALYZING WITH ENHANCED MOCK...';
            
            resultsDiv.innerHTML = `
                <div class="loading-overlay">
                    <div class="loading-spinner"></div>
                    <div class="loading-text">${loadingText}</div>
                </div>
            `;
            resultsDiv.style.display = 'block';
            emptyDiv.style.display = 'none';
            
            try {
                // Get real AI analysis
                const imageDescription = await generateRealImageDescription(imageElement.src);
                const analysisTime = new Date().toISOString();
                const apiUsed = VISION_CONFIG.CLAUDE_API.enabled ? 'CLAUDE-3.5-SONNET' : 
                               VISION_CONFIG.OPENAI_API.enabled ? 'GPT-4-VISION' : 'ENHANCED-MOCK';
                
                // Generate curatorial scores (Nina's algorithm)
                const scores = {
                    'PARIS PHOTO READINESS': Math.floor(Math.random() * 40 + 50),
                    'AI-CRITICALITY': Math.floor(Math.random() * 40 + 60),
                    'CONCEPTUAL STRENGTH': Math.floor(Math.random() * 40 + 45),
                    'TECHNICAL EXCELLENCE': Math.floor(Math.random() * 40 + 55),
                    'CULTURAL DIALOGUE': Math.floor(Math.random() * 40 + 40)
                };
                
                // Calculate weighted total
                const weights = [0.30, 0.25, 0.20, 0.15, 0.10];
                const dimensionNames = Object.keys(scores);
                const total = dimensionNames.reduce((sum, name, i) => sum + scores[name] * weights[i], 0);
                
                // Determine verdict
                const verdict = total >= 75 ? 'INCLUDE' : total >= 50 ? 'MAYBE' : 'EXCLUDE';
                const verdictClass = total >= 75 ? 'verdict-include' : total >= 50 ? 'verdict-maybe' : 'verdict-exclude';
                
                // Build results HTML
                const html = `
                    <div class="ai-analysis-section">
                        <div class="ai-analysis-title">
                            ü§ñ REAL AI VISION ANALYSIS
                            <div style="margin-left: auto; font-size: 9px; color: #666;">${apiUsed}</div>
                        </div>
                        <div class="ai-analysis-content">${imageDescription}</div>
                        <div class="ai-analysis-meta">
                            <span>ANALYZED: ${analysisTime.substring(0, 19).replace('T', ' ')}</span>
                            <span>ENGINE: ${apiUsed}</span>
                        </div>
                    </div>
                    
                    <div class="verdict-header">
                        <div>
                            <div class="total-score">${total.toFixed(1)}</div>
                            <div style="color: #9CA3AF; font-size: 10px; margin-top: 4px; text-transform: uppercase; letter-spacing: 0.1em; font-weight: bold;">NINA'S SCORE</div>
                        </div>
                        <div class="verdict-badge ${verdictClass}">${verdict}</div>
                    </div>
                    
                    <div style="font-size: 11px; color: #666; text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 16px;">
                        CURATORIAL EVALUATION BASED ON REAL AI VISUAL ANALYSIS
                    </div>
                `;
                
                resultsDiv.innerHTML = html;
                
            } catch (error) {
                console.error('Evaluation failed:', error);
                resultsDiv.innerHTML = `
                    <div style="color: #ff6b00; text-align: center; padding: 40px;">
                        <div style="font-size: 14px; font-weight: bold; margin-bottom: 8px;">ANALYSIS ERROR</div>
                        <div style="font-size: 11px;">${error.message}</div>
                    </div>
                `;
            }
        }

        // File upload handling
        function setupUploadZone() {
            const zone = document.getElementById('single-upload');
            const input = document.getElementById('single-file');

            zone.addEventListener('click', () => input.click());
            
            zone.addEventListener('dragover', (e) => {
                e.preventDefault();
                zone.style.borderColor = '#9CA3AF';
            });

            zone.addEventListener('dragleave', () => {
                zone.style.borderColor = '#1F2937';
            });

            zone.addEventListener('drop', (e) => {
                e.preventDefault();
                zone.style.borderColor = '#1F2937';
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    handleFile(files[0]);
                }
            });

            input.addEventListener('change', (e) => {
                if (e.target.files.length > 0) {
                    handleFile(e.target.files[0]);
                }
            });
        }

        // Handle uploaded file
        function handleFile(file) {
            if (file && file.type.startsWith('image/')) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    const zone = document.getElementById('single-upload');
                    zone.classList.add('has-image');
                    zone.innerHTML = `<img src="${e.target.result}" class="preview-image">`;
                    document.getElementById('single-evaluate').disabled = false;
                };
                reader.readAsDataURL(file);
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            loadAPIKeys();
            setupUploadZone();
            
            document.getElementById('single-evaluate').addEventListener('click', () => {
                evaluateSingle().catch(console.error);
            });
        });

        // Close API config when clicking outside
        document.addEventListener('click', function(e) {
            const config = document.getElementById('api-config');
            const status = document.getElementById('api-status');
            if (!config.contains(e.target) && !status.contains(e.target)) {
                config.classList.remove('visible');
            }
        });
    </script>
</body>
</html>